contrdについて

contrdはSCATで計算した三次元の電子密度，静電ポテンシャル，波動関数をテキストファイル
に出力するFortranプログラムです．contrの三次元版です．


【使用方法】
contrdは三つのファイルf09，f39，c04d（下記）を読み込みます．
VENUS\Examples\VEND\SCATにこれらのファイルの例が収めてあります．

球棒模型などを作成する際には，MAKEF05用入力ファイルf01をVICSが入力します．
VICSで作成した*.vcsをさらにVENDで読み込み，構造模型と等値面を重ね合わせる場合は，
両イメージの大きさを一致させるためにf01とc04dを同一フォルダに置き，両者をVICSで
読み込んでから，*.vcsを作成しなければなりません．f01には直方体の大きさ（下記）が
書かれていないからです．

テキストファイルf01，バイナリーファイルf09（固有ベクトルの値）とf39（全変数配列の値）
については，次の書籍を参照してください：

小和田善之, 田中 功, 中松博英, 水野正隆,「はじめての電子状態計算」足立裕彦監修,
三共出版 (1998).


○ contrd用入力ファイル（c04d）

3Dデータを出力する領域を直方体のボックスで指定します．f01に座標が記録されている
すべての原子はこのボックス中に入っていなければなりません．

電子密度と静電ポテンシャルは常に出力されます．

波動関数を出力したい場合は4行目で指定します．最大10個まで出力できます．

1行目（3I5）     x, y, z方向のメッシュ数
2行目（3F10.5）  x, y, z方向の長さ（原子単位ボーア，a0で表記．a0 = 0.52917721 Å）
3行目（3F10.5）  中心座標
4行目（16I5）    ファイルに出力する波動関数の数と波動関数の番号
※ スピンの向きを指定する場合のみ5行目を追加
5行目（X5,16I5） 波動関数のスピンの向き:　1: up, 2: down


○ 入力ファイル例
   41   41   41
  20.00000  20.00000  20.00000
   0.00000   0.00000   0.00000
   2   37  385

この場合は，(0,0,0)を中心とし，大きさ20a0 × 20a0 × 20a0の直方体中の
三次元データを出力します．

出力する波動関数の数は2で，37番と385番の波動関数が出力されます．
波動関数の番号については「はじめての電子状態計算」の109ページ，
"波動関数・電子密度などの等高線の作図をする"を参照してください．

スピン計算の場合は，波動関数の番号の直下にupとdownを識別する番号を追加します．
   41   41   41
  20.00000  20.00000  20.00000
   0.00000   0.00000   0.00000
   2   37  385
        1    2

この場合，37番はupスピン，385番はdownスピンの波動関数が出力されます．

なおVICSで結晶構造を表示する際，f01だけでなくc04d中の格子定数と原点の位置も
読み込まれます．この場合，f01とc04dが同一フォルダに含まれていないと,
エラーが発生しますので，ご注意ください．


○ 出力ファイル名
CHG3D.TXT      電子密度
POT3D.TXT      静電ポテンシャル
WXXX-3D.TXT    XXX番の波動関数
WXXXU-3D.txt   スピン計算の場合のupスピンの波動関数
WXXXD-3D.txt   スピン計算の場合のdownスピンの波動関数

VENDで処理するときは，これらのファイルを*.scatと改名します．
Menu Bar中の[Open]をクリックし，ファイルフォーマットSCATを指定して*.scatを
読み込みます．

○ contrdの実行方法
VENUS\contrd\execに置かれているバッチファイルcontrd.batを使ってcontrdを実行します．
1番目の引数を%1，2番目の引数を%2で表した場合，
contrd arg1 arg2
とコマンドラインで入力します．ただし，arg1はプログラムのサイズ（n, s, w, u, g,
h, i, jのいずれか一つ），arg2はf09，f39，c04dを収めたフォルダのパスを表します．
arg2が長すぎると，うまく動かない可能性があります．その場合は，より浅い階層に
f09，f39，c04dを移してください．

contrdのソースプログラムcontrd.fはVENUS\contrd\SCATに，8つの変数サイズに対応
する実行形式ファイルはVENUS\contrd\objectに置かれています．プログラムのサイズ
については「はじめての電子状態計算」付録，B-3からB-5を参照してください．


○ 出力ファイル形式
1行目（3I5,3F10.5） メッシュ数と各辺の長さ．
2行目以降（E14.6）  X行Y列の2次元データがZ組出力されます．
※ Y方向のメッシュ数が72以上の場合，１行につき10列のデータが
(10E14.6)の書式で出力されます．

出力データの単位については，VENUS.pdf中のVEND: Appendix Aを参照してください．

2002.09.30 水野正隆記
2003.09.26 泉 富士夫修正
